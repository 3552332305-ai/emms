import{i as f,d as j,r as C,a as z,j as F,c as S,b as n,w as o,f as a,o as r,g as p,h as _,k as b,F as H,l as q,t as k,m as L,_ as R}from"./index-b752bdec.js";const G=async()=>{const{data:s}=await f.get("/admin/component-types");return s},J=async s=>{const{data:m}=await f.post("/admin/component-types",s);return m},K=async(s,m)=>{const{data:d}=await f.put(`/admin/component-types/${s}`,m);return d},O=async()=>{const{data:s}=await f.get("/admin/stock-records");return s},P={class:"page"},Q={class:"card-title"},W=j({__name:"AdminDashboard",setup(s){const m=C([]),d=C([]),e=z({visible:!1,title:"新增类型",isEdit:!1,isSubmitting:!1,currentId:0,form:{name:"",description:"",safetyStock:0}}),v=async()=>{m.value=await G(),d.value=await O()},x=()=>{e.visible=!0,e.title="新增类型",e.isEdit=!1,e.currentId=0,e.form={name:"",description:"",safetyStock:0}},D=i=>{e.visible=!0,e.title="编辑类型",e.isEdit=!0,e.currentId=i.id,e.form={name:i.name,description:i.description||"",safetyStock:i.safetyStock||0}},E=async()=>{if(e.form.name){e.isSubmitting=!0;try{e.isEdit?await K(e.currentId,e.form):await J(e.form),e.visible=!1,await v()}finally{e.isSubmitting=!1}}},T=i=>L(i).format("YYYY-MM-DD HH:mm");return F(()=>{v()}),(i,t)=>{const u=a("el-button"),c=a("el-table-column"),A=a("el-table"),g=a("el-card"),V=a("el-col"),I=a("el-empty"),B=a("el-timeline-item"),N=a("el-timeline"),U=a("el-row"),w=a("el-input"),y=a("el-form-item"),Y=a("el-input-number"),M=a("el-form"),$=a("el-dialog");return r(),S("div",P,[n(U,{gutter:16},{default:o(()=>[n(V,{md:12,sm:24},{default:o(()=>[n(g,null,{header:o(()=>[p("div",Q,[t[6]||(t[6]=p("span",null,"物料类型管理",-1)),n(u,{type:"primary",size:"small",onClick:x},{default:o(()=>[...t[5]||(t[5]=[_("新增类型",-1)])]),_:1})])]),default:o(()=>[n(A,{data:m.value,stripe:"","empty-text":"暂无数据",height:"360"},{default:o(()=>[n(c,{prop:"name",label:"名称"}),n(c,{prop:"description",label:"描述"}),n(c,{prop:"safetyStock",label:"安全库存",width:"120"}),n(c,{width:"80",label:"操作"},{default:o(({row:l})=>[n(u,{link:"",type:"primary",size:"small",onClick:X=>D(l)},{default:o(()=>[...t[7]||(t[7]=[_("编辑",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),n(V,{md:12,sm:24},{default:o(()=>[n(g,null,{header:o(()=>[...t[8]||(t[8]=[p("span",null,"出入库记录",-1)])]),default:o(()=>[d.value.length?(r(),b(N,{key:1},{default:o(()=>[(r(!0),S(H,null,q(d.value,l=>(r(),b(B,{key:l.id,timestamp:T(l.createdAt)},{default:o(()=>[p("p",null,k(l.componentName)+" 数量 "+k(l.quantity),1),p("small",null,"操作人："+k(l.operator),1)]),_:2},1032,["timestamp"]))),128))]),_:1})):(r(),b(I,{key:0,description:"暂无记录"}))]),_:1})]),_:1})]),_:1}),n($,{modelValue:e.visible,"onUpdate:modelValue":t[4]||(t[4]=l=>e.visible=l),title:e.title,width:"480px"},{footer:o(()=>[n(u,{onClick:t[3]||(t[3]=l=>e.visible=!1)},{default:o(()=>[...t[9]||(t[9]=[_("取消",-1)])]),_:1}),n(u,{type:"primary",loading:e.isSubmitting,onClick:E},{default:o(()=>[...t[10]||(t[10]=[_("保存",-1)])]),_:1},8,["loading"])]),default:o(()=>[n(M,{model:e.form,"label-width":"100px"},{default:o(()=>[n(y,{label:"名称"},{default:o(()=>[n(w,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.form.name=l)},null,8,["modelValue"])]),_:1}),n(y,{label:"描述"},{default:o(()=>[n(w,{modelValue:e.form.description,"onUpdate:modelValue":t[1]||(t[1]=l=>e.form.description=l),type:"textarea"},null,8,["modelValue"])]),_:1}),n(y,{label:"安全库存"},{default:o(()=>[n(Y,{modelValue:e.form.safetyStock,"onUpdate:modelValue":t[2]||(t[2]=l=>e.form.safetyStock=l),min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const h=R(W,[["__scopeId","data-v-50e2e3cf"]]);export{h as default};
