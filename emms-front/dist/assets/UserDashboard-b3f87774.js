import{i as _,d as R,r as c,a as C,j as U,c as P,b as t,w as e,f as n,o as k,g as i,h as D,t as A,_ as B}from"./index-b752bdec.js";const O=async()=>{const{data:s}=await _.get("/user/inventory");return s},T=async s=>{const{data:r}=await _.post("/user/usage",s);return r},G=async()=>{const{data:s}=await _.get("/user/usage");return s},J={class:"page"},S=R({__name:"UserDashboard",setup(s){const r=c([]),f=c([]),p=c(!1),o=C({componentId:1,quantity:1}),b=async()=>{r.value=await O(),f.value=await G()},q=async()=>{if(!(!o.componentId||o.quantity<=0)){p.value=!0;try{await T({componentId:o.componentId,quantity:o.quantity}),await b()}finally{p.value=!1}}},E=d=>({PENDING:"审批中",APPROVED:"已通过",REJECTED:"已拒绝"})[d],I=d=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger"})[d];return U(()=>{b()}),(d,a)=>{const l=n("el-table-column"),y=n("el-table"),m=n("el-card"),w=n("el-col"),g=n("el-input-number"),v=n("el-form-item"),V=n("el-button"),N=n("el-form"),h=n("el-row"),x=n("el-tag");return k(),P("div",J,[t(h,{gutter:16},{default:e(()=>[t(w,{md:14,sm:24},{default:e(()=>[t(m,null,{header:e(()=>[...a[2]||(a[2]=[i("span",null,"库存概览",-1)])]),default:e(()=>[t(y,{data:r.value,stripe:"","empty-text":"暂无库存数据"},{default:e(()=>[t(l,{prop:"componentName",label:"物料"}),t(l,{prop:"available",label:"可用数量",width:"120"}),t(l,{prop:"unit",label:"单位",width:"100"})]),_:1},8,["data"])]),_:1})]),_:1}),t(w,{md:10,sm:24},{default:e(()=>[t(m,null,{header:e(()=>[...a[3]||(a[3]=[i("span",null,"领用申请",-1)])]),default:e(()=>[t(N,{model:o,"label-position":"top"},{default:e(()=>[t(v,{label:"物料 ID"},{default:e(()=>[t(g,{modelValue:o.componentId,"onUpdate:modelValue":a[0]||(a[0]=u=>o.componentId=u),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(v,{label:"数量"},{default:e(()=>[t(g,{modelValue:o.quantity,"onUpdate:modelValue":a[1]||(a[1]=u=>o.quantity=u),min:1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(V,{type:"primary",loading:p.value,class:"w-full",onClick:q},{default:e(()=>[...a[4]||(a[4]=[D(" 提交申请 ",-1)])]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1}),t(m,{class:"mt-16"},{header:e(()=>[...a[5]||(a[5]=[i("span",null,"申请历史",-1)])]),default:e(()=>[t(y,{data:f.value,stripe:"","empty-text":"暂无申请记录"},{default:e(()=>[t(l,{prop:"componentName",label:"物料"}),t(l,{prop:"quantity",label:"数量",width:"100"}),t(l,{prop:"status",label:"状态",width:"120"},{default:e(({row:u})=>[t(x,{type:I(u.status)},{default:e(()=>[D(A(E(u.status)),1)]),_:2},1032,["type"])]),_:1}),t(l,{prop:"requestedAt",label:"申请时间",width:"180"})]),_:1},8,["data"])]),_:1})])}}});const F=B(S,[["__scopeId","data-v-d9e45b17"]]);export{F as default};
